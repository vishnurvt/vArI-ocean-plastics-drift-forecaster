# File Summary:
# - Pre-commit hook configuration enforcing formatting and linting standards.
# - Runs black, isort, ruff, and docformatter on staged Python files.
# - Install with make precommit prior to contributing.

repos:
  - repo: https://github.com/psf/black
    rev: 23.7.0
    hooks:
      - id: black
  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort
  - repo: https://github.com/charliermarsh/ruff-pre-commit
    rev: v0.0.289
    hooks:
      - id: ruff
        args: ["--fix"]
  - repo: https://github.com/myint/docformatter
    rev: v1.7.3
    hooks:
      - id: docformatter
        args: ["--in-place", "--wrap-summaries=100", "--wrap-descriptions=100"]
  - repo: local
    hooks:
      - id: ensure-mit-license
        name: Ensure MIT license header
        entry: python -c "import sys, pathlib; hdr1='# Copyright (c) 2025 Oceans Four Driftcast Team'; hdr2='# SPDX-License-Identifier: MIT'; failures=[];\\nfor path in sys.argv[1:]:\\n    lines=pathlib.Path(path).read_text(encoding='utf8').splitlines();\\n    if len(lines)<2 or lines[0].strip()!=hdr1 or lines[1].strip()!=hdr2:\\n        failures.append(path)\\n;\\nif failures:\\n    print('Missing MIT header:', *failures, sep='\\n  '); sys.exit(1)"
        language: system
        files: "\\.py$"
      - id: ensure-file-summary
        name: Ensure File Summary docstring
        entry: python -c "import sys, pathlib; failures=[];\\nfor path in sys.argv[1:]:\\n    lines=pathlib.Path(path).read_text(encoding='utf8').splitlines();\\n    idx=0\\n    while idx < len(lines) and lines[idx].strip().startswith('#'):\\n        idx += 1\\n    while idx < len(lines) and not lines[idx].strip():\\n        idx += 1\\n    ok=False\\n    if idx < len(lines):\\n        line=lines[idx].strip()\\n        if line == '\"\"\"' and idx + 1 < len(lines):\\n            ok = lines[idx+1].strip().startswith('File Summary')\\n        elif line.startswith('\"\"\"File Summary'):\\n            ok = True\\n    if not ok:\\n        failures.append(path)\\n;\\nif failures:\\n    print('Missing File Summary header:', *failures, sep='\\n  '); sys.exit(1)"
        language: system
        files: "\\.py$"
